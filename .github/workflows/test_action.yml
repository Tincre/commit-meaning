name: Test Commit Meaning Action
on: [push]

jobs:
  get-commit-meaning:
    outputs:
      description: ${{ steps.get_commit_meaning.outputs.description}}
    runs-on: ubuntu-latest
    name: Returns a description of the latest commits
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Get the commit meaning
        id: get_commit_meaning
        uses: ./
        with:
          openai-api-key: "${{ secrets.OPENAI_API_KEY }}"

  write-to-pr:
    needs: get-commit-meaning
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
    steps:
      - uses: mshick/add-pr-comment@v2
        with:
          message: |
            ${{ needs.get-commit-meaning.ouputs.description }}
